# 问题处理
## 1. 数据库置疑
### 原因分析
1. 是操作员没有正常关闭SYBASE系统。
2. 是由于异常情况，如：掉电、硬件故障等。
### 解决方法
#### 方法一  
1. 操作系统下，关闭数据库后，使用"fsck -y"进行恢复，重新启动机器；
2. 单用户启动sybase数据库，执行statserver -f RUN_SYB -m
3. 修改sysdatabases表中状态位,isql执行
　　update sysdatabases set status= 0 where name='tmdb'  
　　update sysdatabases set status2 = 0 where name='tmdb'  
在还需对“挂起”的数据库进行修复  
　　dbcc checkdb(tmdb)  
　　dbcc checkalloc(tmdb)  
然后重新启动数据库；检查是否已经恢复。  

#### 方法二
1. 在命令行状态下输入命令将系统表置为允许修改状态
```sql
isql  -Usa -SDBSVR -PChangeme_123
1>sp_configure "allow updates",1
2>go
3>update sysdatabases set status = -32768　where name = "dbName"
4>go
如果得到 1 row affectged,则执行commit
5>commit
6>go
否则执行rollback
>rollback
>go
```
2. 重启sybase服务
3. 截断数据库log
```sql
use dbName
go
dump tran dbName with no_log
go
```
如果执行截断有错误,执行以下:  
```sql
dbcc rebuild_log(dbName,1,1)
```
注意: 本步骤所有操作均有风险,需先考虑风险后再操作.  

4. 重启sybase服务
3. 修改数据库的状态为正常，系统表置为不允许修改状态。
```sql
1>update sysdatabases set status = 0　where name ="dbName"
２>go
３>sp_configure "allowupdates",0
４>go
```
**`重启sybase服务`** 
关闭:  
```sql
isql  -Usa -SDBSVR -PChangeme_123
shutdown SYB_BACKUP
go
shutdown
go
```
启动:  
```
. /opt/sybase/SYBASE.sh
cd /opt/sybase/ASE-1*/install/
./startserver -f ./RUN_DBSVR &
./startserver -f ./RUN_DBSVR_BAK &
```

## 2. 查询表时报692错误

