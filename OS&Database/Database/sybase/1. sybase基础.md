# sybase基础
## 安装

下载安装包， 解压到/opt/sybase，注意必须目录是这样的/opt/sybase/ASE-15_0/install/ ，因为RUN_DBSVR里面写死了/opt/sybase/ASE-15_0/bin/dataserver  

## 登录
命令行执行：  
```shell
cd /opt/sybase
export LANG=C                         --- 有时候不可缺少，有时候又不能有这行，否则报错。
. SYBASE.sh
isql -Usa -PTest1234* -SDBSVR        --- 登录
```

## 启动
记得先 ：export LANG=C  

       --  如果 /opt/SYBASE下面的文件的属主都是root，就不要切换dbuser用户了！！

 首先要切换到dbuser用户，命令：  
 
```shell
su - dbuser
. SYBASE.sh   ------- 执行环境变量；
 cd /opt/sybase/ASE-15_0/install/ 
./RUN_DBSVR&       回车；  （---启动主库,要加&）http://zhidao.baidu.com/question/569385907.html  其实和./startserver -f RUN_DBSVR一个作用
./RUN_DBSVR_back&     (--启动备份数据库)
```
 
## 查看数据库是否起来
1. 可以使用：ps –ef|grep sybase查看也可以执行  
2. 也可用：  

```shell
cd /opt/sybase/ASE-15_0/install
./showserver
```

## 停止
执行命令：  

```shell
SYBASE.sh
isql -Usa –Pchangeme123 -SDBSVR
select * from sysservers                   --查找备份数据库的实例名；
go
shutdown SYB_BACKUP                        --SYB_BACKUP是备份数据库的名称
go
shutdown
go
```
 

## 忘记sa密码&修改sa密码

[参考学习链接：](http://www.cnblogs.com/poleax81/archive/2006/06/17/428054.html)  

在/opt/sybase/ASE-15_0/install/RUN_DBSVR最后面(不能加在第一行后面)加上行 -psa  
执行  
```shell
./startserver -f RUN_DBSVR
```
注意找到这一行：  
`New SSO password for sa:bojhvjemyvwpz3`

然后：  

```shell
export LANG=C
su - dbuser
isql -Usa -Pbojhvjemyvwpz3 -SDBSVR
sp_password 'bojhvjemyvwpz3',Test1234*　　　　———— 这样就重置密码好了！
```
 
## 其它基础命令
### 查看配置信息 
sp_configure 'con'   
>
>Parameter Name Default Memory Used  
>config Value Run Value Unit   
>Type
>

sp_helpdb                          —— 查看所有数据库状态  
sp_helpdb dbname            —— 查看某个数据库状态  
sp_who                              —— 查看执行中的业务状态  

## 数据库日志
**日志路径：**  
sybase/ASE-15_0/install/DBSVR.log   

出现The transaction log in database tempdb is almost full.  Your transaction is being suspended until space is made available in the log.  
执行  

2> dump transaction with truncate_only  
3> go  
Msg 156, Level 15, State 2:  
Server 'DBSVR', Line 2:  
Incorrect syntax near the keyword 'with'.  —— 郁闷，奇怪， 我是按照网上来的  

1> dump transaction OMSSM with no_log  
2> go


